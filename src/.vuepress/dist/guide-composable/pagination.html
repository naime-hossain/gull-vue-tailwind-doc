<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Pagination | Aatrox</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon.png">
    <meta name="description" content="🚀 Production Ready, Carefully Crafted, Extensive Vue 3 Tailwind Admin Template 🚀">
    
    <link rel="preload" href="/assets/css/0.styles.093e62d5.css" as="style"><link rel="preload" href="/assets/js/app.d6060d8c.js" as="script"><link rel="preload" href="/assets/js/2.d347fc36.js" as="script"><link rel="preload" href="/assets/js/39.0a067b54.js" as="script"><link rel="preload" href="/assets/js/4.3bfcd1eb.js" as="script"><link rel="prefetch" href="/assets/js/10.07f3dd6a.js"><link rel="prefetch" href="/assets/js/11.842fc523.js"><link rel="prefetch" href="/assets/js/12.e785caa3.js"><link rel="prefetch" href="/assets/js/13.fdb12f07.js"><link rel="prefetch" href="/assets/js/14.9144e1c8.js"><link rel="prefetch" href="/assets/js/15.bace1ae4.js"><link rel="prefetch" href="/assets/js/16.891324fc.js"><link rel="prefetch" href="/assets/js/17.c9794947.js"><link rel="prefetch" href="/assets/js/18.24a08ac1.js"><link rel="prefetch" href="/assets/js/19.27df5ea4.js"><link rel="prefetch" href="/assets/js/20.34c2dde6.js"><link rel="prefetch" href="/assets/js/21.ef09050c.js"><link rel="prefetch" href="/assets/js/22.f992592b.js"><link rel="prefetch" href="/assets/js/23.8f880339.js"><link rel="prefetch" href="/assets/js/24.87282a3d.js"><link rel="prefetch" href="/assets/js/25.6c4d6bd1.js"><link rel="prefetch" href="/assets/js/26.59e51c9f.js"><link rel="prefetch" href="/assets/js/27.eebe1132.js"><link rel="prefetch" href="/assets/js/28.00be216d.js"><link rel="prefetch" href="/assets/js/29.4d6b9e7e.js"><link rel="prefetch" href="/assets/js/3.df915ef7.js"><link rel="prefetch" href="/assets/js/30.2476a4cb.js"><link rel="prefetch" href="/assets/js/31.2722c49a.js"><link rel="prefetch" href="/assets/js/32.7112e7af.js"><link rel="prefetch" href="/assets/js/33.1776a5c1.js"><link rel="prefetch" href="/assets/js/34.30049684.js"><link rel="prefetch" href="/assets/js/35.c161bbdf.js"><link rel="prefetch" href="/assets/js/36.c0f3b0c2.js"><link rel="prefetch" href="/assets/js/37.f701f25d.js"><link rel="prefetch" href="/assets/js/38.9bfe8e62.js"><link rel="prefetch" href="/assets/js/40.aaccb5b2.js"><link rel="prefetch" href="/assets/js/41.8406db25.js"><link rel="prefetch" href="/assets/js/42.d640c84a.js"><link rel="prefetch" href="/assets/js/43.167bce97.js"><link rel="prefetch" href="/assets/js/44.dbad1001.js"><link rel="prefetch" href="/assets/js/45.7c12bc58.js"><link rel="prefetch" href="/assets/js/46.72e2e644.js"><link rel="prefetch" href="/assets/js/47.95923bad.js"><link rel="prefetch" href="/assets/js/48.e3130295.js"><link rel="prefetch" href="/assets/js/49.41a3e160.js"><link rel="prefetch" href="/assets/js/5.c754c5c1.js"><link rel="prefetch" href="/assets/js/50.9956d438.js"><link rel="prefetch" href="/assets/js/51.acf07990.js"><link rel="prefetch" href="/assets/js/52.9e942a6f.js"><link rel="prefetch" href="/assets/js/53.45c49bfc.js"><link rel="prefetch" href="/assets/js/54.0a600b12.js"><link rel="prefetch" href="/assets/js/55.eec77fcb.js"><link rel="prefetch" href="/assets/js/56.572c97d8.js"><link rel="prefetch" href="/assets/js/57.abef7689.js"><link rel="prefetch" href="/assets/js/58.a721ebe3.js"><link rel="prefetch" href="/assets/js/59.5e36d5dc.js"><link rel="prefetch" href="/assets/js/6.7023f416.js"><link rel="prefetch" href="/assets/js/60.3a779059.js"><link rel="prefetch" href="/assets/js/7.3722245b.js"><link rel="prefetch" href="/assets/js/8.6417a644.js"><link rel="prefetch" href="/assets/js/9.e0f2787c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.093e62d5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Aatrox</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Guide" class="dropdown-title"><span class="title">Guide</span> <span class="arrow down"></span></button> <button type="button" aria-label="Guide" class="mobile-dropdown-title"><span class="title">Guide</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/guide/" class="nav-link">
  Getting started
</a></li></ul></div></div><div class="nav-item"><a href="https://aatrox-vue.netlify.app/landingpage" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Demo
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/Akryum/vue-apollo" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Guide" class="dropdown-title"><span class="title">Guide</span> <span class="arrow down"></span></button> <button type="button" aria-label="Guide" class="mobile-dropdown-title"><span class="title">Guide</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/guide/" class="nav-link">
  Getting started
</a></li></ul></div></div><div class="nav-item"><a href="https://aatrox-vue.netlify.app/landingpage" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Demo
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/Akryum/vue-apollo" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Composition API Guide</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide-composable/" aria-current="page" class="sidebar-link">Introduction</a></li><li><a href="/guide-composable/setup.html" class="sidebar-link">Setup</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Fetching data</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/guide-composable/query.html" class="sidebar-link">Queries</a></li><li><a href="/guide-composable/mutation.html" class="sidebar-link">Mutations</a></li><li><a href="/guide-composable/subscription.html" class="sidebar-link">Subscriptions</a></li><li><a href="/guide-composable/pagination.html" aria-current="page" class="active sidebar-link">Pagination</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/guide-composable/pagination.html#using-fetchmore" class="sidebar-link">Using fetchMore</a></li><li class="sidebar-sub-header"><a href="/guide-composable/pagination.html#offset-based" class="sidebar-link">Offset-based</a></li><li class="sidebar-sub-header"><a href="/guide-composable/pagination.html#cursor-based" class="sidebar-link">Cursor-based</a></li><li class="sidebar-sub-header"><a href="/guide-composable/pagination.html#relay-style-cursor-pagination" class="sidebar-link">Relay-style cursor pagination</a></li><li class="sidebar-sub-header"><a href="/guide-composable/pagination.html#the-connection-directive" class="sidebar-link">The @connection directive</a></li></ul></li><li><a href="/guide-composable/fragments.html" class="sidebar-link">Using fragments</a></li><li><a href="/guide-composable/error-handling.html" class="sidebar-link">Error handling</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="pagination"><a href="#pagination" class="header-anchor">#</a> Pagination</h1> <p>Often, you will have some views in your application where you need to display a list that contains too much data to be either fetched or displayed at once. Pagination is the most common solution to this problem, and Apollo Client has built-in functionality that makes it quite easy to do.</p> <p>There are basically two ways of fetching paginated data: numbered pages, and cursors. There are also two ways for displaying paginated data: discrete pages, and infinite scrolling. For a more in-depth explanation of the difference and when you might want to use one vs. the other, we recommend that you read Apollo blog post on the subject: <a href="https://medium.com/apollo-stack/understanding-pagination-rest-graphql-and-relay-b10f835549e7" target="_blank" rel="noopener noreferrer">Understanding Pagination<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>In this article, we'll cover the technical details of using Apollo to implement both approaches.</p> <h2 id="using-fetchmore"><a href="#using-fetchmore" class="header-anchor">#</a> Using <code>fetchMore</code></h2> <p>In Apollo, the easiest way to do pagination is with a function called <a href="/caching/cache-interaction/#incremental-loading-fetchmore"><code>fetchMore</code></a>, which is returned by the <code>useQuery</code> composition function. This basically allows you to do a new GraphQL query and merge the result into the original result.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> fetchMore <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useQuery</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token punctuation">)</span>
</code></pre></div><p>You can specify what query and variables to use for the new query, and how to merge the new query result with the existing data on the client. How exactly you do that will determine what kind of pagination you are implementing.</p> <h2 id="offset-based"><a href="#offset-based" class="header-anchor">#</a> Offset-based</h2> <p>Offset-based pagination — also called numbered pages — is a very common pattern, found on many websites, because it is usually the easiest to implement on the backend. In SQL for example, numbered pages can easily be generated by using <a href="https://www.postgresql.org/docs/8.2/static/queries-limit.html" target="_blank" rel="noopener noreferrer">OFFSET and LIMIT<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>Let's take this example query loading a feed of potentially infinite number of posts:</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> useQuery <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vue/apollo-composable'</span>
<span class="token keyword">import</span> gql <span class="token keyword">from</span> <span class="token string">'graphql-tag'</span>

<span class="token keyword">const</span> <span class="token constant">FEED_QUERY</span> <span class="token operator">=</span> gql<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  query getFeed ($type: FeedType!, $offset: Int, $limit: Int) {
    currentUser {
      login
    }
    feed (type: $type, offset: $offset, limit: $limit) {
      id
      # ...
    }
  }
</span><span class="token template-punctuation string">`</span></span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  props<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

  <span class="token function">setup</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> result <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useQuery</span><span class="token punctuation">(</span><span class="token constant">FEED_QUERY</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
      type<span class="token operator">:</span> props<span class="token punctuation">.</span>type<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      result<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>We can use the <code>fetchMore</code> function returned by <code>useQuery</code> to load more posts in the feed:</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><div class="highlighted"> </div><br><br><br><br></div><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  props<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

  <span class="token function">setup</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> result<span class="token punctuation">,</span> fetchMore <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useQuery</span><span class="token punctuation">(</span><span class="token constant">FEED_QUERY</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
      type<span class="token operator">:</span> props<span class="token punctuation">.</span>type<span class="token punctuation">,</span>
      offset<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      limit<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">function</span> <span class="token function">loadMore</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">fetchMore</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        variables<span class="token operator">:</span> <span class="token punctuation">{</span>
          offset<span class="token operator">:</span> result<span class="token punctuation">.</span>feed<span class="token punctuation">.</span>length<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      result<span class="token punctuation">,</span>
      loadMore<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>By default, <code>fetchMore</code> will use the original <code>query</code>, so we just pass in new variables.</p> <p>Once the new data is returned from the server, the <code>updateQuery</code> option is used to merge it with the existing data, which will cause a re-render of your UI component with an expanded list:</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br></div><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  props<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

  <span class="token function">setup</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> result<span class="token punctuation">,</span> fetchMore <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useQuery</span><span class="token punctuation">(</span><span class="token constant">FEED_QUERY</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
      type<span class="token operator">:</span> props<span class="token punctuation">.</span>type<span class="token punctuation">,</span>
      offset<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      limit<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">function</span> <span class="token function">loadMore</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">fetchMore</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        variables<span class="token operator">:</span> <span class="token punctuation">{</span>
          offset<span class="token operator">:</span> result<span class="token punctuation">.</span>feed<span class="token punctuation">.</span>length<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">updateQuery</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">previousResult<span class="token punctuation">,</span> <span class="token punctuation">{</span> fetchMoreResult <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token comment">// No new feed posts</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>fetchMoreResult<span class="token punctuation">)</span> <span class="token keyword">return</span> previousResult

          <span class="token comment">// Concat previous feed with new feed posts</span>
          <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token operator">...</span>previousResult<span class="token punctuation">,</span>
            feed<span class="token operator">:</span> <span class="token punctuation">[</span>
              <span class="token operator">...</span>previousResult<span class="token punctuation">.</span>feed<span class="token punctuation">,</span>
              <span class="token operator">...</span>fetchMoreResult<span class="token punctuation">.</span>feed<span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      result<span class="token punctuation">,</span>
      loadMore<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The above approach works great for limit/offset pagination. One downside of pagination with numbered pages or offsets is that an item can be skipped or returned twice when items are inserted into or removed from the list at the same time. That can be avoided with cursor-based pagination.</p> <p>Note that in order for the UI component to receive an updated <code>loading</code> ref after <code>fetchMore</code> is called, you must set <code>notifyOnNetworkStatusChange</code> to <code>true</code> in your <code>useQuery</code> options.</p> <h2 id="cursor-based"><a href="#cursor-based" class="header-anchor">#</a> Cursor-based</h2> <p>In cursor-based pagination, a &quot;cursor&quot; is used to keep track of where in the data set the next items should be fetched from. Sometimes the cursor can be quite simple and just refer to the ID of the last object fetched, but in some cases — for example lists sorted according to some criteria — the cursor needs to encode the sorting criteria in addition to the ID of the last object fetched.</p> <p>Implementing cursor-based pagination on the client isn't all that different from offset-based pagination, but instead of using an absolute offset, we keep a reference to the last object fetched and information about the sort order used.</p> <p>In the example below, we use a <code>fetchMore</code> query to continuously load new posts, which will be prepended to the list. The cursor to be used in the <code>fetchMore</code> query is provided in the initial server response, and is updated whenever more data is fetched.</p> <div class="language-js extra-class"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br></div><pre class="language-js"><code><span class="token keyword">const</span> <span class="token constant">FEED_QUERY</span> <span class="token operator">=</span> gql<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  query getFeed ($type: FeedType!) {
    currentUser {
      login
    }
    feed (type: $type) {
      cursor
      posts {
        id
        # ...
      }
    }
  }
</span><span class="token template-punctuation string">`</span></span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  props<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

  <span class="token function">setup</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> result<span class="token punctuation">,</span> fetchMore <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useQuery</span><span class="token punctuation">(</span><span class="token constant">FEED_QUERY</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
      type<span class="token operator">:</span> props<span class="token punctuation">.</span>type<span class="token punctuation">,</span>
      offset<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      limit<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">function</span> <span class="token function">loadMore</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">fetchMore</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token comment">// note this is a different query than the one used in `useQuery`</span>
        query<span class="token operator">:</span> gql<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
          query getMoreFeed ($cursor) {
            moreFeed (type: $type, cursor: $cursor) {
              cursor
              posts {
                id
                # ...
              }
            }
          }
        </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
        variables<span class="token operator">:</span> <span class="token punctuation">{</span>
          cursor<span class="token operator">:</span> result<span class="token punctuation">.</span>feed<span class="token punctuation">.</span>cursor<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">updateQuery</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">previousResult<span class="token punctuation">,</span> <span class="token punctuation">{</span> fetchMoreResult <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token operator">...</span>previousResult<span class="token punctuation">,</span>
            feed<span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token operator">...</span>previousResult<span class="token punctuation">.</span>feed<span class="token punctuation">,</span>
              <span class="token comment">// Update cursor</span>
              cursor<span class="token operator">:</span> fetchMoreResult<span class="token punctuation">.</span>moreFeed<span class="token punctuation">.</span>cursor<span class="token punctuation">,</span>
              <span class="token comment">// Concat previous feed with new feed posts</span>
              posts<span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token operator">...</span>previousResult<span class="token punctuation">.</span>feed<span class="token punctuation">.</span>posts<span class="token punctuation">,</span>
                <span class="token operator">...</span>fetchMoreResult<span class="token punctuation">.</span>moreFeed<span class="token punctuation">.</span>posts<span class="token punctuation">,</span>
              <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      result<span class="token punctuation">,</span>
      loadMore<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="relay-style-cursor-pagination"><a href="#relay-style-cursor-pagination" class="header-anchor">#</a> Relay-style cursor pagination</h2> <p>Relay, another popular GraphQL client, is opinionated about the input and output of paginated queries, so people sometimes build their server's pagination model around Relay's needs. If you have a server that is designed to work with the <a href="https://facebook.github.io/relay/graphql/connections.htm" target="_blank" rel="noopener noreferrer">Relay Cursor Connections<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> spec, you can also call that server from Apollo Client with no problems.</p> <p>Using Relay-style cursors is very similar to basic cursor-based pagination.  The main difference is in the format of the query response which affects where you get the cursor.</p> <p>Relay provides a <code>pageInfo</code> object on the returned cursor connection which contains the cursor of the first and last items returned as the properties <code>startCursor</code> and <code>endCursor</code> respectively.  This object also contains a boolean property <code>hasNextPage</code> which can be used to determine if there are more results available.</p> <p>The following example specifies a request of 10 items at a time and that results should start after the provided <code>cursor</code>.  If <code>null</code> is passed for the cursor relay will ignore it and provide results starting from the beginning of the data set which allows the use of the same query for both initial and subsequent requests.</p> <div class="language-js extra-class"><div class="highlight-lines"><br><div class="highlighted"> </div><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-js"><code><span class="token keyword">const</span> <span class="token constant">FEED_QUERY</span> <span class="token operator">=</span> gql<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  query getFeed ($type: FeedType!, $cursor: String) {
    currentUser {
      login
    }
    feed (type: $type, first: 10, after: $cursor) {
      edges {
        node {
          id
          # ...
        }
      }
      pageInfo {
        endCursor
        hasNextPage
      }
    }
  }
</span><span class="token template-punctuation string">`</span></span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  props<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'type'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

  <span class="token function">setup</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> result<span class="token punctuation">,</span> fetchMore <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useQuery</span><span class="token punctuation">(</span><span class="token constant">FEED_QUERY</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
      type<span class="token operator">:</span> props<span class="token punctuation">.</span>type<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">function</span> <span class="token function">loadMore</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">fetchMore</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        variables<span class="token operator">:</span> <span class="token punctuation">{</span>
          cursor<span class="token operator">:</span> result<span class="token punctuation">.</span>feed<span class="token punctuation">.</span>pageInfo<span class="token punctuation">.</span>endCursor<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">updateQuery</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">previousResult<span class="token punctuation">,</span> <span class="token punctuation">{</span> fetchMoreResult <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">const</span> newEdges <span class="token operator">=</span> fetchMoreResult<span class="token punctuation">.</span>feed<span class="token punctuation">.</span>edges
          <span class="token keyword">const</span> pageInfo <span class="token operator">=</span> fetchMoreResult<span class="token punctuation">.</span>feed<span class="token punctuation">.</span>pageInfo

          <span class="token keyword">return</span> newEdges<span class="token punctuation">.</span>length <span class="token operator">?</span> <span class="token punctuation">{</span>
            <span class="token operator">...</span>previousResult<span class="token punctuation">,</span>
            feed<span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token operator">...</span>previousResult<span class="token punctuation">.</span>feed<span class="token punctuation">,</span>
              <span class="token comment">// Concat edges</span>
              edges<span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token operator">...</span>previousResult<span class="token punctuation">.</span>feed<span class="token punctuation">.</span>edges<span class="token punctuation">,</span>
                <span class="token operator">...</span>newEdges<span class="token punctuation">,</span>
              <span class="token punctuation">]</span><span class="token punctuation">,</span>
              <span class="token comment">// Override with new pageInfo</span>
              pageInfo<span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span> <span class="token operator">:</span> previousResult
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      result<span class="token punctuation">,</span>
      loadMore<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="the-connection-directive"><a href="#the-connection-directive" class="header-anchor">#</a> The <code>@connection</code> directive</h2> <p>When using paginated queries, results from accumulated queries can be hard to find in the store, as the parameters passed to the query are used to determine the default store key but are usually not known outside the piece of code that executes the query. This is problematic for imperative store updates, as there is no stable store key for updates to target. To direct Apollo Client to use a stable store key for paginated queries, you can use the optional <code>@connection</code> directive to specify a store key for parts of your queries. For example, if we wanted to have a stable store key for the feed query earlier, we could adjust our query to use the <code>@connection</code> directive:</p> <div class="language-graphql extra-class"><div class="highlight-lines"><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-graphql"><code><span class="token keyword">query</span> <span class="token definition-query function">Feed</span><span class="token punctuation">(</span><span class="token variable">$type</span><span class="token punctuation">:</span> <span class="token class-name">FeedType</span><span class="token operator">!</span><span class="token punctuation">,</span> <span class="token variable">$offset</span><span class="token punctuation">:</span> <span class="token scalar">Int</span><span class="token punctuation">,</span> <span class="token variable">$limit</span><span class="token punctuation">:</span> <span class="token scalar">Int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token object">currentUser</span> <span class="token punctuation">{</span>
    <span class="token property">login</span>
  <span class="token punctuation">}</span>
  <span class="token property-query">feed</span><span class="token punctuation">(</span><span class="token attr-name">type</span><span class="token punctuation">:</span> <span class="token variable">$type</span><span class="token punctuation">,</span> <span class="token attr-name">offset</span><span class="token punctuation">:</span> <span class="token variable">$offset</span><span class="token punctuation">,</span> <span class="token attr-name">limit</span><span class="token punctuation">:</span> <span class="token variable">$limit</span><span class="token punctuation">)</span> <span class="token directive function">@connection</span><span class="token punctuation">(</span><span class="token attr-name">key</span><span class="token punctuation">:</span> <span class="token string">&quot;feed&quot;</span><span class="token punctuation">,</span> <span class="token attr-name">filter</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;type&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token property">id</span>
    <span class="token comment"># ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This would result in the accumulated feed in every query or <code>fetchMore</code> being placed in the store under the <code>feed</code> key, which we could later use for imperative store updates. In this example, we also use the <code>@connection</code> directive's optional <code>filter</code> argument, which allows us to include some arguments of the query in the store key. In this case, we want to include the <code>type</code> query argument in the store key, which results in multiple store values that accumulate pages from each type of feed.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/Akryum/vue-apollo/edit/v4/packages/docs/src/guide-composable/pagination.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">10/10/2021, 5:47:58 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/guide-composable/subscription.html" class="prev">
        Subscriptions
      </a></span> <span class="next"><a href="/guide-composable/fragments.html">
        Using fragments
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.d6060d8c.js" defer></script><script src="/assets/js/2.d347fc36.js" defer></script><script src="/assets/js/39.0a067b54.js" defer></script><script src="/assets/js/4.3bfcd1eb.js" defer></script>
  </body>
</html>
